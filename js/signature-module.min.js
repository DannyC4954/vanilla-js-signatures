const eventTypes=["mousedown","mouseup","mouseout","mousemove","touchstart","touchend","touchcancel","touchmove"];class SignatureBox{#painting=!1;constructor(canvasElement,containerWidth){this.canvas=canvasElement,this.ctx=this.canvas.getContext("2d"),this.canvas.height=250,this.canvas.width=containerWidth,this.#setupEventListeners()}#setupEventListeners(){eventTypes.forEach((eventType=>this.canvas.addEventListener(eventType,this.#handleEvent.bind(this))))}#handleEvent(event){const handlers={mousedown:this.#startDrawing,touchstart:this.#startDrawing,mouseup:this.#stopDrawing,touchend:this.#stopDrawing,mouseout:this.#cancelDrawing,touchcancel:this.#cancelDrawing,mousemove:this.#draw,touchmove:this.#draw};handlers[event.type]?.call(this,event)}#startDrawing(event){this.#painting=!0,this.#draw(event)}#stopDrawing(){this.#painting=!1,this.ctx.beginPath(),this.#updateSignatureData()}#cancelDrawing(){this.#painting=!1,this.ctx.beginPath(),0===this.ctx.canvas.parentNode.querySelector(".signature-data").value.length&&this.#updateSignatureIndicator(!1)}#draw(event){if(!this.#painting)return;const rect=this.canvas.getBoundingClientRect();let x=event.clientX??event.touches[0].clientX-rect.left,y=event.clientY??event.touches[0].clientY-rect.top;x=null==event.clientX?event.touches[0].clientX-rect.left:event.clientX-rect.left,y=null==event.clientY?event.touches[0].clientY-rect.top:event.clientY-rect.top,this.ctx.lineWidth=4,this.ctx.lineCap="round",this.ctx.lineTo(x,y),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(x,y)}#updateSignatureData(){this.canvas.parentNode.querySelector(".signature-data").value=this.canvas.toDataURL(),this.#updateSignatureIndicator(!0)}#updateSignatureIndicator(success=!1){const indicator=this.canvas.parentNode.querySelector(".signature-indicator");indicator.textContent="";const iconClass=success?"fa-check":"fa-times",pillClass=success?"pill-success":"pill-error";indicator.appendChild(SignatureBox.#createIcon(iconClass,pillClass))}static#createIcon(iconClass,pillClass){const span=document.createElement("span");span.className=pillClass;const icon=document.createElement("i");return icon.className=`fa ${iconClass}`,span.appendChild(icon),span}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath(),this.canvas.parentNode.querySelector(".signature-data").value="",this.canvas.parentNode.querySelector(".signature-indicator").textContent=""}}export function initializeSignatureBoxes(){const container=document.querySelector(".canvas-container"),containerWidth=container?.clientWidth??300,canvasElements=document.querySelectorAll(".signature-box"),signatureBoxes=Array.from(canvasElements).map((canvas=>new SignatureBox(canvas,containerWidth)));document.querySelectorAll(".clear-canvas-btn").forEach(((btn,index)=>{btn.addEventListener("click",(()=>signatureBoxes[index].clear()))}))}